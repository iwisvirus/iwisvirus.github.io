---
layout: post
title: TryHackMe | Windows Forensics 2
date: 2025-12-17
categories: DFIR
---

Some hands-on task for parsing NTFS files and getting data.

**1. Parse the $MFT file placed in **C:\users\THM-4n6\Desktop\triage\C** and analyze it. What
is the Size of the file located at **.\Windows\Security\logs\SceSetupLog.etl** (49152)**

To parse $MFT files, we type

**MFTECmd.exe -f “path to $MFT file” –csv “path to save in csv”**

In the command line. Below is what some examples when you type in **$MFTECmd.exe**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows21.png)

You can open up csv files using the EZViewer tool. When you open up the file, you can see
different files, file sizes, if it’s in use etc. IT stores information about clusters where all other
objects present on the volume are located.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows22.png)

You can see here the **.\Windows\Security\logs\SceSetupLog.etl** has a file size of 49152.


![PDF Info Screenshot]({{ site.baseurl }}/images/windows23.png)

**2. What is the size of the cluster for the volume from which this triage has taken? (4096)**

For this one, you have to look through $Boot file. You can see here the cluster size is 4096.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows24.png)

These are some hands-on task for recovering deleted files. Usually, data on a disk usually
does not get deleted but the location itself. I used the Autopsy tool and performed the
analysis on a disk image. The ones with X mark are the ones that are deleted. You can
recover it by selecting the Extract file.

**1. There is another xlsx file that was deleted. What is the full name of that file?
(Tryhackme.xlsx)**

**2. What is the name of the TXT file that was deleted from the disk? (TryHackMe2.txt)**
![PDF Info Screenshot]({{ site.baseurl }}/images/windows25.png)

**3. Recover the TXT file from question #w. What was written in this txt file? (thm-4n6-2-4)**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows26.png)

Hands-on practice on finding artifacts present in the file system.

**1. How many times was gkape.exe executed?(2)**

Windows Prefetch files store information about programs that are run such as last run times,
number of times it was run, any files and device handles used by the file, size, etc. It is used
to load programs quickly in case of frequent use and excellent source of information about
the last executed programs and files. It is usually found in **C:\Windows\Prefetch**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows27.png)

You can use

**PECmd.exe -d “pathway to prefetch” –csv “pathway to save”**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows28.png)

And you can see it was executed twice.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows29.png)

**2. What is the last execution time of gkape.exe(12/01/2021 13:04)**

Same with number 1, you can see the last execution time is 12/01/2021 13:04.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows30.png)

**3. When Notepad.exe was opened on 11/30/2021 at 10:56, how long did it remain in
focus?(00:00:41)**

Windows 10 stores recently used applications and files in an SQLite database called
Windows 10 Timeline. This data can be a source of information about the last executed
programs. It contains the application that was executed, start time, duration, last modified
time, and the focus time of the application. It is usually found in

**C:\Users\<username>\Appdata\Local\ConnectedDevicesPlatform\{random
folder}\ActivitiesCache.db**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows31.png)

You can run it by

**WxTCmd.exe -f “pathway to file” –csv “pathway to save”**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows32.png)

You can see the focus time for Notepad.exe is 41 seconds.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows33.png)

**4. What program was used to open C:\Users\THM-4n6\Desktop/KAPE/KAPE/ChangeLog.txt?(Notepad.exe)**

Windows Jump lists help users go directly to their recently used files from the taskbar. It
contains information like when it was modified, creation time, It is usually stored in etc

**C:\Users\<username>\Appdata\Roaming\Microsoft\Windows\Recent\AutomaticDestina
tions.**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows34.png)

You can run it by

**JLECmd.exe -f “pathway to file” –csv “pathway to save”**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows35.png)

You can see Notepad.exe was used to open changelog.txt.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows36.png)

Windows creates a shortcut file for each files opened which contains information about the
first and last opened times of the file and the path of the opened file. They are usually found
in

**C:\Users\<username>\AppData\Roaming\Microsoft\windows\Recent**

or

**C:\Users\<username>\AppData\Roaming\Microsoft\Office\Recent**

You can run it by

**LECmd.exe -f “path-to-shortcut--files” –csv “path-to-save-csv”**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows37.png)

The file contains the sourcefile, when it was created, modified, accessed, when the target
was created, modified, accessed, filesize, and so on.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows38.png)

**IE/Edge History**

IE/Edge History includes opened files which makes it a valuable source of information. We
can access it from

__C:\Users\<username>\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat__

And the files and folders that has been accessed appear with a __file:\\\*__. I used Autopsy for
this case. You can find a lot of information for different datas such as the programs in the
computer, web history, web cache, recent documents, web search and so on.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows39.png)

**1. When was the folder C:\Users\THM-4n6\Desktop\regripper last opened? (12/1/2021
13:01)**

**2. When was the above-mentioned folder first opened? (12/1/2021 12:31)**

For this, I had to extract JLECmd.exe from the recent file where they store all the shortcut
paths like below.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows40.png)

In the terminal window, you can find the regripper information. It contains information about
when the folder was first opened and when it was last opened.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows41.png)

Information about USB devices are stored in **setupapi.dev.log** which could be found in

**C:\Windows\inf\setupapi.dev.log**

You can find information like device ID, serial number, first/last time the device was
connected and so on. Sometimes, information such as volume name, type, and serial
number.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows42.png)












