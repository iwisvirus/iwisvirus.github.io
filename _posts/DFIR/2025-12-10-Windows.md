---
layout: post
title: TryHackMe | Windows Forensics
date: 2025-12-09
categories: DFIR
---

This week, I finished the DFIR introduction and Windows forensics. There are many tools you can use to retrieve data about a Windows program on a computer but I would say Registry Explorer made by Eric Zimmerman is the most convenient. Registry Explorer is basically a collection of databases that contain the system’s configuration data.  I wrote down a whole table of Registry Forensics command line, but they had a neater cheatsheet. 


![PDF Info Screenshot]({{ site.baseurl }}/images/windows1.png)

So basically, there are many hives and each hive contains different information. Maybe registry keys(Window+R/regedit.exe) and some additional ones that might be useful. 

**HKEY_CURRENT_USER(HKCU)**
- Root of config info for logged in user
- Folders, screen colour, control panel setting

**HKEY_USERS(HKU)**
- All actively loaded user profiles on computer

**HKEY_LOCAL_MACHINE(HKLM)**
- Config info to computer

**HKEY_CLASSES_ROOT(HKCR)**
- Subkey of HKEY_LOCAL_MACHINE\Software
- Make sure correct program opens 
- Merges the two keys below
  **HKEY_LOCAL_MACHINE\Software\Classes**
  - Default settings that can apply to all users
  - Change here if changing default settings 
  - Key’s key info stored
  **HKEY_CURRENT_USER\Software\Classes**
  - Settings that override the default settings and apply only to interactive user
  - Change here if changing settings for interactive user
  - Key’s value stored if key exists

**HKEY_CURRENT_CONFIG**
- Information about hardware profile 

Registry hives

**C:\Windows\System32\Config**
  - DEFAULT(HKEY_USERS\DEFAULT)
  - SAM(HKEY_LOCAL_MACHINE\Sam)
   - registry hive file that acts as a local database for storing user account information and hashed passwords
  - SECURITY(HKEY_LOCAL_MACHINE\Security)
  - SOFTWARE(HKEY_LOCAL_MACHINE\Software)
  - SYSTEM (HKEY_LOCAL_MACHINE\System)

User info hives

**C:\Users\<username>**

- NTUSER.DAT(HKEY_CURRENT_USER)

**C:\Users\<username>\AppData\Local\Microsoft\Windows**
- USRCLASS.DAT(HKEY_CURRENT_USER\Software\CLASSES)

Amcache hives

**C:\Windows\AppCompat\Programs\Amcache.hve**
- Save info on programs that were recently run on system 

Registry backups

**C:\Windows\System32\Config\RegBack**
- Hives copied every 10 days. 

Some hands-on task I’ve done for this course. I used the virtual machine on Try Hack Me and solved the problems using Registry 

**1. How many user created accounts are present on the system? (3)**

You can find this in the SAM hive in **SAM\Domains\Account\Users**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows2.png)

I got to here, then I got stuck on figuring out how many user created accounts there are. Basically, the Users numbers are in hexadecimal. Account number below 1000 are accounts that are already embedded in the computer. So, there are 3, 0X3E9, 0X3EA, and 0X3EB. I found out later that there is a column about the account information. 


![PDF Info Screenshot]({{ site.baseurl }}/images/windows3.png)

**2. What is the username of the account that has never been logged in? (thm-user2)**

From here, you can see thm-user2 doesn’t have last login time. I had a bit of trouble finding
this out too.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows4.png)

**3. What’s the password hint for the user THM-4n6? (count)**

You can see from the first picture that THM-4n6 has the value of 0X3E9. So I checked the
user account and looked into the UserPasswordHint where I found ‘c.o.u.n.t’.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows5.png)

![PDF Info Screenshot]({{ site.baseurl }}/images/windows6.png)

**4. When was the file ‘Changelog.txt’ accessed? (2021-11-24 18:18:48)**

Recently opened files can be found in NTUSER.DAT hive in

**NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs**

![PDF Info Screenshot]({{ site.baseurl }}/images/windows7.png)

**5. What is the complete path from where the python 3.8.2 installer was
run?(Z:\setups\python-3.8.2.exe)**

This one was the most tricky part out of all the questions for windows. Basically, I had to go in to the SOFTWARE hive and go into

**SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist**

And found the python 3.8.2 exe pathway.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows8.png)

**6. When was the USB device with the friendly name ‘USB’ last connected? (2021-11-24
18:40:06)**

USB can be found in the SOFTWARE hive in 

**SOFTWARE\Microsoft\Windows Portable Devices\Devices**

Device starting E251921 has the friendly name USB.

![PDF Info Screenshot]({{ site.baseurl }}/images/windows9.png)

The timestamp for USB can be found in the SYSTEM hive in

**ControlSet001\Enum\USBSTOR**

The device id starting with e251921’s last connected time is 2021-11-24 18:40:06


![PDF Info Screenshot]({{ site.baseurl }}/images/windows10.png)


