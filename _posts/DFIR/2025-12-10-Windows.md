---
layout: post
title: Windows Forensics
date: 2025-12-09
categories: DFIR
---

This week, I finished the DFIR introduction and Windows forensics. There are many tools you can use to retrieve data about a Windows program on a computer but I would say Registry Explorer made by Eric Zimmerman is the most convenient. Registry Explorer is basically a collection of databases that contain the system’s configuration data.  I wrote down a whole table of Registry Forensics command line, but they had a neater cheatsheet. 


![PDF Info Screenshot]({{ site.baseurl }}/images/windows1.png)

So basically, there are many hives and each hive contains different information. Maybe registry keys(Window+R/regedit.exe) and some additional ones that might be useful. 

**HKEY_CURRENT_USER(HKCU)**
- Root of config info for logged in user
- Folders, screen colour, control panel setting

**HKEY_USERS(HKU)**
- All actively loaded user profiles on computer

**HKEY_LOCAL_MACHINE(HKLM)**
- Config info to computer

**HKEY_CLASSES_ROOT(HKCR)**
- Subkey of HKEY_LOCAL_MACHINE\Software
- Make sure correct program opens 
- Merges the two keys below
  **HKEY_LOCAL_MACHINE\Software\Classes**
  - Default settings that can apply to all users
  - Change here if changing default settings 
  - Key’s key info stored
  **HKEY_CURRENT_USER\Software\Classes**
  - Settings that override the default settings and apply only to interactive user
  - Change here if changing settings for interactive user
  - Key’s value stored if key exists

**HKEY_CURRENT_CONFIG**
- Information about hardware profile 

Registry hives
**C:\Windows\System32\Config**
  DEFAULT(HKEY_USERS\DEFAULT)
  SAM(HKEY_LOCAL_MACHINE\Sam)
  - registry hive file that acts as a local database for storing user account information and hashed passwords
  SECURITY(HKEY_LOCAL_MACHINE\Security)
  SOFTWARE(HKEY_LOCAL_MACHINE\Software)
  SYSTEM (HKEY_LOCAL_MACHINE\System)

User info hives
**C:\Users\<username>**
NTUSER.DAT(HKEY_CURRENT_USER)

**C:\Users\<username>\AppData\Local\Microsoft\Windows**
USRCLASS.DAT(HKEY_CURRENT_USER\Software\CLASSES)

Amcache hives
**C:\Windows\AppCompat\Programs\Amcache.hve**
- Save info on programs that were recently run on system 

Registry backups
**C:\Windows\System32\Config\RegBack**
- Hives copied every 10 days. 

Some hands-on task I’ve done for this course. I used the virtual machine on Try Hack Me and solved the problems using Registry 

**1. How many user created accounts are present on the system? (3)**
You can find this in the SAM hive in **SAM\Domains\Account\Users**


![PDF Info Screenshot]({{ site.baseurl }}/images/windows2.png)

I got to here, then I got stuck on figuring out how many user created accounts there are. Basically, the Users numbers are in hexadecimal. Account number below 1000 are accounts that are already embedded in the computer. So, there are 3, 0X3E9, 0X3EA, and 0X3EB. I found out later that there is a column about the account information. 

![PDF Info Screenshot]({{ site.baseurl }}/images/intro3.png)

I also tested it on a jpg image I have on my computer. 

![PDF Info Screenshot]({{ site.baseurl }}/images/intro4.png)
